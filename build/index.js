(()=>{"use strict";var e,t={21:()=>{const e=window.wp.blocks,t=window.React,a=window.wp.element,n=window.wp.components,o=window.wp.blockEditor,l=window.wp.i18n,c={},r=(e,t)=>e.cmc!==t.cmc?e.cmc-t.cmc:e.name.localeCompare(t.name),s=e=>e.length+1,m=(e,a)=>(s(a),a.length>0?(0,t.createElement)("div",{key:e},(0,t.createElement)("h2",{className:"has-small-font-size"},`${e} (${(e=>e.reduce(((e,t)=>e+(t.quantity||1)),0))(a)})`),(0,t.createElement)("div",{className:"mtg-tools-card-category"},a.map(((e,a)=>(0,t.createElement)("div",{key:e.id||a,className:"mtg-tools-card has-small-font-size","data-card-name":e.scryfallName||e.name,"data-card-front-image-uri":e.frontImage||"","data-card-back-image-uri":e.backImage||"","data-card-foil":e.foil?"Yes":"No"},(0,t.createElement)("span",{className:"mtg-tools-quantity"},e.quantity||1),(0,t.createElement)("div",{className:"mtg-tools-card-wrapper"},(0,t.createElement)("div",{className:"mtg-tools-tooltip-wrapper"},(0,t.createElement)("p",{className:"mtg-tools-card-name mtg-tooltip","data-tippy-content":`<div class="mtg-tools-tooltip-content">\n\t\t\t\t\t\t\t\t\t<img src="${e.frontImage||""}" alt="${e.scryfallName||e.name}" class="mtg-tools-tooltip-image" data-front-image="${e.frontImage}" data-back-image="${e.backImage||""}"/>\n\t\t\t\t\t\t\t\t\t${e.backImage?'<button class="mtg-tools-toggle-image">Show Back</button>':""}\n\t\t\t\t\t\t\t\t</div>`},e.scryfallName||e.name),e.backImage&&(0,t.createElement)("div",{className:"mtg-tools-flip-button"},(0,t.createElement)("button",{className:"mtg-tools-flip dashicons dashicons-image-rotate",type:"button"}))))))))):null),i=JSON.parse('{"UU":"mtg-tools/mtg-tools"}');(0,e.registerBlockType)(i.UU,{edit:function({attributes:e,setAttributes:r}){const s=(0,o.useBlockProps)(),[m,i]=(0,a.useState)(e.cards||[]),[d,u]=(0,a.useState)(!1),g=(0,a.useRef)(null),p=["Creature","Land","Artifact","Enchantment","Planeswalker","Battle","Instant","Sorcery"],f=(e,t,a)=>{const n=[...m];n[e][t]=a,i(n),r({cards:n}),"name"!==t&&"set"!==t&&"number"!==t||((e,t)=>{clearTimeout(g.current),g.current=setTimeout((()=>{u(!0),(async(e,t)=>{const a=`${e.name}-${e.set}-${e.number}`;if(c[a])return c[a];let n="";n=e.set&&e.number?`https://api.scryfall.com/cards/${encodeURIComponent(e.set)}/${encodeURIComponent(e.number)}`:`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(e.name)}&set=${encodeURIComponent(e.set)}`;try{const e=await fetch(n),t=await e.json();if(200===e.status)return c[a]=t,t;if(404===e.status)return{status:404,message:"Not Found"}}catch(e){}finally{u(!1)}})(e).then((a=>{if(a){const n=[...m];let o=null,l=null,c="",s="",d=e.name;if(404===a.status)n[t]={...n[t],notFound:!0};else{"modal_dfc"===a.layout||"transform"===a.layout?(o=a.card_faces?.[0]?.image_uris?.normal||null,l=a.card_faces?.[1]?.image_uris?.normal||null,c=a.card_faces?.[0]?.mana_cost,s=a.card_faces?.[0]?.type_line,d=a.card_faces?.[0]?.name):"adventure"===a.layout?(o=a.image_uris?.normal||null,c=a.mana_cost,s=a.card_faces?.[0]?.type_line||a.type_line,d=a.card_faces?.[0]?.name||a.name):(o=a.image_uris?.normal||null,c=a.mana_cost,s=a.type_line,d=a.name);const e=(e=>{const t=e.split(" ");for(let e of p)if(t.includes(e))return e;return t[0]||"Unknown"})(s);n[t]={...n[t],scryfallName:d,scryfallSet:a.set_name,scryfallCollectorNumber:a.collector_number,cmc:a.cmc,manaCost:c,type:e,frontImage:o,backImage:l,scryfall_uri:a.scryfall_uri,notFound:!1}}i(n),r({cards:n})}}))}),1e3)})(n[e],e)};return(0,t.createElement)("div",{...s},d,m.map(((e,a)=>(0,t.createElement)("div",{key:a,className:"mtg-card"},(0,t.createElement)("div",{className:"card-inputs"},(0,t.createElement)(n.TextControl,{label:(0,l.__)("Name","mtg-tools"),value:e.name,onChange:e=>f(a,"name",e)}),(0,t.createElement)(n.TextControl,{label:(0,l.__)("Set","mtg-tools"),value:e.set,onChange:e=>f(a,"set",e)}),(0,t.createElement)(n.TextControl,{label:(0,l.__)("Number","mtg-tools"),value:e.number,onChange:e=>f(a,"number",e)}),(0,t.createElement)(n.TextControl,{label:(0,l.__)("Quantity","mtg-tools"),type:"number",value:e.quantity,onChange:e=>f(a,"quantity",parseInt(e))}),(0,t.createElement)(n.CheckboxControl,{label:(0,l.__)("Commander","mtg-tools"),checked:e.commander,onChange:e=>f(a,"commander",e)}),(0,t.createElement)(n.CheckboxControl,{label:(0,l.__)("Foil","mtg-tools"),checked:e.foil,onChange:e=>f(a,"foil",e)})),(0,t.createElement)("div",{className:"card-preview"},e.notFound?(0,t.createElement)("div",{className:"not-found"},(0,l.__)("Not Found","mtg-tools")):e.frontImage?(0,t.createElement)("img",{src:e.frontImage,alt:e.name}):(0,t.createElement)("div",{className:"placeholder"})),(0,t.createElement)(n.Button,{isDestructive:!0,onClick:()=>(e=>{const t=m.filter(((t,a)=>a!==e));i(t),r({cards:t})})(a)},(0,l.__)("Remove Card","mtg-tools"))))),(0,t.createElement)(n.Button,{isPrimary:!0,onClick:()=>{const e={name:"",set:"",number:"",quantity:1,commander:!1,foil:!1};i([...m,e]),r({cards:[...m,e]})}},(0,l.__)("Add Card","mtg-tools")))},save:function({attributes:e}){const a=o.useBlockProps.save(),{cards:n=[]}=e,l=n.filter((e=>e.commander)).sort(r),c=[{type:"Artifacts",condition:e=>"Artifact"===e.type&&!e.commander},{type:"Battles",condition:e=>"Battle"===e.type&&!e.commander},{type:"Creatures",condition:e=>"Creature"===e.type&&!e.commander},{type:"Planeswalkers",condition:e=>"Planeswalker"===e.type&&!e.commander},{type:"Enchantments",condition:e=>"Enchantment"===e.type&&!e.commander},{type:"Instants",condition:e=>"Instant"===e.type&&!e.commander},{type:"Sorceries",condition:e=>"Sorcery"===e.type&&!e.commander},{type:"Lands",condition:e=>"Land"===e.type&&!e.commander}].reduce(((e,t)=>(e[t.type]=n.filter(t.condition).sort(r),e)),{}),i={Commander:l,...c},d=Object.values(i).reduce(((e,t)=>e+s(t)),0),u=Math.ceil(d/2);let g={},p={},f=0;for(const[e,t]of Object.entries(i)){const a=s(t);f+a<=u||0===Object.keys(g).length?(g[e]=t,f+=a):p[e]=t}const y=l[0]||Object.values(c).flat()[0],b=y?.frontImage,v=y?.scryfallName||"Magic: The Gathering Card",_=y?.foil?"Yes":"No";return(0,t.createElement)("div",{...a,className:"mtg-tools-container"},(0,t.createElement)("div",{className:"mtg-tools-column mtg-tools-image-column"},(0,t.createElement)("div",{className:"mtg-tools-sticky"},(0,t.createElement)("img",{id:"mtg-tools-default-image",src:b,alt:v,className:"mtg-tools-image","data-foil":_}),y?.foil&&(0,t.createElement)("div",{className:"mtg-tools-gradient-overlay"}))),(0,t.createElement)("div",{className:"mtg-tools-column"},Object.entries(g).map((([e,t])=>m(e,t)))),(0,t.createElement)("div",{className:"mtg-tools-column"},Object.entries(p).map((([e,t])=>m(e,t)))))}})}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var l=a[e]={exports:{}};return t[e](l,l.exports,n),l.exports}n.m=t,e=[],n.O=(t,a,o,l)=>{if(!a){var c=1/0;for(i=0;i<e.length;i++){for(var[a,o,l]=e[i],r=!0,s=0;s<a.length;s++)(!1&l||c>=l)&&Object.keys(n.O).every((e=>n.O[e](a[s])))?a.splice(s--,1):(r=!1,l<c&&(c=l));if(r){e.splice(i--,1);var m=o();void 0!==m&&(t=m)}}return t}l=l||0;for(var i=e.length;i>0&&e[i-1][2]>l;i--)e[i]=e[i-1];e[i]=[a,o,l]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var o,l,[c,r,s]=a,m=0;if(c.some((t=>0!==e[t]))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(s)var i=s(n)}for(t&&t(a);m<c.length;m++)l=c[m],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(i)},a=globalThis.webpackChunkmagic_decks_and_cards=globalThis.webpackChunkmagic_decks_and_cards||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=n.O(void 0,[350],(()=>n(21)));o=n.O(o)})();